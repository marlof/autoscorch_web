<!DOCTYPE html>
<html lang="en" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">
<head>
<meta charset="utf-8" />
<meta name="Generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="../8-e-integration-ansible.html" />
<link rel="shortlink" href="21.html" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<link rel="shortcut icon" href="../sites/all/themes/responsive_blog/favicon.ico" type="image/vnd.microsoft.icon" />
<title>Integration with Ansible | ScOrch</title>
<style type="text/css" media="all">
@import url("../modules/system/system.base.css%3Fqgglep.css");
@import url("../modules/system/system.menus.css%3Fqgglep.css");
@import url("../modules/system/system.messages.css%3Fqgglep.css");
@import url("../modules/system/system.theme.css%3Fqgglep.css");
</style>
<style type="text/css" media="all">
@import url("../modules/field/theme/field.css%3Fqgglep.css");
@import url("../modules/node/node.css%3Fqgglep.css");
@import url("../modules/search/search.css%3Fqgglep.css");
@import url("../modules/user/user.css%3Fqgglep.css");
</style>
<style type="text/css" media="all">
@import url("../sites/all/themes/responsive_blog/css/color-schemes.css%3Fqgglep.css");
</style>
<style type="text/css" media="all">
@import url("../sites/all/themes/responsive_blog/style.css%3Fqgglep.css");
</style>
<script type="text/javascript" src="../misc/jquery.js%3Fv=1.4.4"></script>
<script type="text/javascript" src="../misc/jquery-extend-3.4.0.js%3Fv=1.4.4"></script>
<script type="text/javascript" src="../misc/jquery-html-prefilter-3.5.0-backport.js%3Fv=1.4.4"></script>
<script type="text/javascript" src="../misc/jquery.once.js%3Fv=1.2"></script>
<script type="text/javascript" src="../misc/drupal.js%3Fqgglep"></script>
<script type="text/javascript" src="../sites/all/themes/responsive_blog/js/main-menu.js%3Fqgglep"></script>
<script type="text/javascript" src="../sites/all/themes/responsive_blog/js/pngfix.min.js%3Fqgglep"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"responsive_blog","theme_token":"9jT8xcfF5QDxR4bBFgxFSlOPKqzMKmZTstkKn4W3NNc","js":{"modules\/statistics\/statistics.js":1,"misc\/jquery.js":1,"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery-html-prefilter-3.5.0-backport.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/themes\/responsive_blog\/js\/main-menu.js":1,"sites\/all\/themes\/responsive_blog\/js\/pngfix.min.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/search\/search.css":1,"modules\/user\/user.css":1,"sites\/all\/themes\/responsive_blog\/css\/color-schemes.css":1,"sites\/all\/themes\/responsive_blog\/css\/dark.css":1,"sites\/all\/themes\/responsive_blog\/style.css":1}},"statistics":{"data":{"nid":"21"},"url":"\/modules\/statistics\/statistics.php"}});
//--><!]]>
</script>
<!--[if lt IE 9]><script src="/sites/all/themes/responsive_blog/js/html5.js"></script><![endif]-->
</head>
<body class="html not-front not-logged-in one-sidebar sidebar-first page-node page-node- page-node-21 node-type-page dark">
    <div id="wrapper">
  <header id="header" class="clearfix">
                                <div class="social-profile">
        <ul>
                    <li class="twitter">
            <a target="_blank" title="ScOrch in Twitter" href="https://twitter.com/webmarcitltd">ScOrch Twitter </a>
          </li>                              <li class="rss">
            <a target="_blank" title="ScOrch in RSS" href="../rss.xml">ScOrch RSS </a>
          </li>
        </ul>
      </div>
        <nav id="navigation" role="navigation">
      <div id="main-menu">
        <ul class="menu"><li class="first leaf"><a href="../index.html">Home</a></li>
<li class="collapsed"><a href="../scorch.html" title="ScOrch - Orchestration">Orchestration</a></li>
<li class="collapsed"><a href="../scorchdb.html" title="CMDB - Single Source of Truth">CMDB</a></li>
<li class="collapsed"><a href="../obrar.html" title="Obrar - The Work Horse">Framework</a></li>
<li class="collapsed"><a href="../community.html">Community</a></li>
<li class="leaf"><a href="../download.html">Download</a></li>
<li class="last expanded active-trail"><a href="../documentation.html" title="ScOrch Documentation" class="active-trail">Documentation</a><ul class="menu"><li class="first leaf"><a href="../documentation/installation.html">Installation</a></li>
<li class="leaf"><a href="../documentation/jobs.html">Jobs</a></li>
<li class="leaf"><a href="../documentation/tasks.html">Tasks</a></li>
<li class="leaf"><a href="../&lt;p&gt;Plugins&#32;connect&#32;templates&#32;to&#32;jobs&lt;/p&gt;&#32;&#32;&lt;p&gt;Plugins&#32;are&#32;functions&#32;that&#32;translate&#32;a&#32;simple&#32;template&#32;into&#32;a&#32;powerful&#32;set&#32;of&#32;instructions.&#32;They&#32;are&#32;essentially&#32;additional&#32;bash&#32;functions&#32;that&#32;are&#32;sourced&#32;just&#32;before&#32;they.html">Plugins</a></li>
<li class="leaf"><a href="../documentation/superplugins.html">Super Plugins</a></li>
<li class="leaf active-trail"><a href="../8-e-integration-ansible.html" class="active-trail active">Integration with Ansible</a></li>
<li class="last leaf"><a href="../documentation/jira-integration.html">Jira Integration</a></li>
</ul></li>
</ul>      </div>
    </nav>
  </header>

  <div id="preface-area" class="clearfix">
    
      </div>

  <div id="main" class="clearfix">
    <div id="primary">
      <section id="content" role="main">
        
        <div id="breadcrumbs"><h2 class="element-invisible">You are here</h2><nav class="breadcrumb"><a href="../index.html">Home</a> » <a href="../documentation.html" title="ScOrch Documentation" class="active-trail">Documentation</a> » Integration with Ansible</nav></div>                        <div id="content-wrap">
                    <h1 class="page-title">Integration with Ansible</h1>                                                  <div class="region region-content">
  <div id="block-system-main" class="block block-system">

      
  <div class="content">
                        <span property="dc:title" content="Integration with Ansible" class="rdf-meta element-hidden"></span>  
      
    
  <div class="content">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>The initial plan for using Ansible at is to gradually replace existing obrar tasks within scorch with Ansible playbooks.   This modular approach allows us to migrate to using Ansible as the underlying deployment mechanism without the large risk associated with a 'big bang' approach.</p>
<p> </p>
<h2>Sample scorch plugin</h2>
<p>The sample below shows how easy it is to utilize an Ansible playbook with scorch .    In this example we require two input variables based on the ENVIRONMENT and RELEASE parameters passed to scorch in the add template.   These are mandatory for this plugin, if they are not specified the job will fail.   Once received they are passed to the Ansible playbook using the --extra-vars switch.</p>
<h3>scorch template to invoke this plugin</h3>
<p>ACTION : ANSIBLE_DEMO</p>
<p>ENVIRONMENT : &lt;any DEV or TEST environment i.e DEV1, FT1, etc&gt;</p>
<p>RELEASE : A valid baseline release i.e VR-5.6.6</p>
<p> </p>
<h3>Plugin Source</h3>
<p><strong>Ansible_DEMO plugin</strong></p>
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td>
<p>Plugin_ANSIBLE-DEMO()</p>
<p>{</p>
<p> </p>
<p>   # Check we have what we need</p>
<p>   [[ -z ${RELEASE} ]] &amp;&amp; WPError "No release set"</p>
<p>   [[ -z ${ENVIRONMENT} ]] &amp;&amp; WPError "No environment set"</p>
<p> </p>
<p># OK we have some input vars, let's try and run it</p>
<p> </p>
<p># Hard coded locations for ansible binary, environment and playbooks</p>
<p> </p>
<p>AddTask "/usr/bin/ansible-playbook -i /deployment/ansible/space/environments/DEV/deployment/ansible/space/common/playbooks/VERSIONREPORT.yml --extra-vars \"{'RELEASE':'${RELEASE}','ENV':'${ENVIRONMENT}'}\""</p>
<p> </p>
<p># Now the same using the envvars from the ansible_profile</p>
<p> </p>
<p>AddTask "$ANSIBLE_BIN/ansible-playbook -i $ANSIBLE_HOME/environments/$ANSIBLE_ENV $ANSIBLE_HOME/common/playbooks/VERSIONREPORT.yml --extra-vars \"{'RELEASE':'${RELEASE}','ENV':'${ENVIRONMENT}'}\""</p>
<p> </p>
<p># Example limiting ansible playbook to a single tag on a single NDT environment (using the scorch environment variable) and for just a subset of hosts for CSS</p>
<p> </p>
<p>AddTask "$ANSIBLE_BIN/ansible-playbook -i $ANSIBLE_HOME/environments/$ANSIBLE_ENV/${ENVIRONMENT} $ANSIBLE_HOME/common/playbooks/python.yml --limit \"CSS\" --tags \"pyver\""</p>
<p> </p>
<p># Example limiting ansible playbook to a two tags on a single NDT environment (using the scorch environment variable) and for just a subset of hosts for CSS</p>
<p> </p>
<p>AddTask "$ANSIBLE_BIN/ansible-playbook -i $ANSIBLE_HOME/environments/$ANSIBLE_ENV/${ENVIRONMENT} $ANSIBLE_HOME/common/playbooks/python.yml --limit \"CSS\" --tags \"debug,pyall\""</p>
<p> </p>
<p>}</p>
</td>
</tr></tbody></table><h2>Using tags to allow single task invocation from an Ansible Playbook</h2>
<p>It's very simple to run just a single task from a playbook that contains many of them by using ansible tags to limit the scope of your play.   Using the scorch AddTask we can simply specify the tag we need from a playbook as shown below;</p>
<p><strong>Running a single tag from a playbook</strong></p>
<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td>
<p>AddTask "$ANSIBLE_BIN/ansible-playbook -i $ANSIBLE_HOME/environments/$ANSIBLE_ENV $ANSIBLE_HOME/common/playbooks/python.yml --tags \"pyver\""</p>
</td>
</tr></tbody></table><p> </p>
<p>In this example we'll invoke the python.yml playbook which contains several tasks but we'll only run the ones with the "pyver" tag.   In essence this will limit the tasks run to just one of the four available in the playbook.</p>
</div></div></div>  </div>

      <footer>
          </footer>
  
    </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
        </div>
      </section> <!-- /#main -->
    </div>

          <aside id="sidebar" role="complementary">
       <div class="region region-sidebar-first">
  <div id="block-system-main-menu" class="block block-system block-menu">

        <h2 >Main menu</h2>
    
  <div class="content">
    <ul class="menu"><li class="first leaf"><a href="../index.html">Home</a></li>
<li class="collapsed"><a href="../scorch.html" title="ScOrch - Orchestration">Orchestration</a></li>
<li class="collapsed"><a href="../scorchdb.html" title="CMDB - Single Source of Truth">CMDB</a></li>
<li class="collapsed"><a href="../obrar.html" title="Obrar - The Work Horse">Framework</a></li>
<li class="collapsed"><a href="../community.html">Community</a></li>
<li class="leaf"><a href="../download.html">Download</a></li>
<li class="last expanded active-trail"><a href="../documentation.html" title="ScOrch Documentation" class="active-trail">Documentation</a><ul class="menu"><li class="first leaf"><a href="../documentation/installation.html">Installation</a></li>
<li class="leaf"><a href="../documentation/jobs.html">Jobs</a></li>
<li class="leaf"><a href="../documentation/tasks.html">Tasks</a></li>
<li class="leaf"><a href="../&lt;p&gt;Plugins&#32;connect&#32;templates&#32;to&#32;jobs&lt;/p&gt;&#32;&#32;&lt;p&gt;Plugins&#32;are&#32;functions&#32;that&#32;translate&#32;a&#32;simple&#32;template&#32;into&#32;a&#32;powerful&#32;set&#32;of&#32;instructions.&#32;They&#32;are&#32;essentially&#32;additional&#32;bash&#32;functions&#32;that&#32;are&#32;sourced&#32;just&#32;before&#32;they.html">Plugins</a></li>
<li class="leaf"><a href="../documentation/superplugins.html">Super Plugins</a></li>
<li class="leaf active-trail"><a href="../8-e-integration-ansible.html" class="active-trail active">Integration with Ansible</a></li>
<li class="last leaf"><a href="../documentation/jira-integration.html">Jira Integration</a></li>
</ul></li>
</ul>  </div>
  
</div> <!-- /.block -->
</div>
 <!-- /.region -->
      </aside> 
      </div>

  <footer id="footer-bottom">
    <div id="footer-area" class="clearfix">
            
          </div>

    <div id="bottom" class="clearfix">
      <div class="copyright">Copyright &copy; 2020, <a href="../index.html">ScOrch</a></div>
      <div class="credit">Theme by  <a href="http://www.devsaran.com" target="_blank">Devsaran</a></div>
    </div>
  </footer>

</div>






  <script type="text/javascript" src="../modules/statistics/statistics.js%3Fqgglep"></script>
</body>
</html>